\documentclass[sigplan, screen, natbib=false, review]{acmart}
%%
%% \BibTeX command to typeset BibTeX logo in the docs
\AtBeginDocument{%
  \providecommand\BibTeX{{%
Bib\TeX}}}

%% Rights management information.  This information is sent to you
%% when you complete the rights form.  These commands have SAMPLE
%% values in them; it is your responsibility as an author to replace
%% the commands and values with those provided to you when you
%% complete the rights form.
\setcopyright{acmlicensed}
\copyrightyear{2025}
\acmYear{2025}
\acmDOI{XXXXXXX.XXXXXXX}
%% These commands are for a PROCEEDINGS abstract or paper.
% \acmConference[Conference acronym 'XX]{Make sure to enter the correct
% conference title from your rights confirmation email}{June 03--05,
% 2018}{Woodstock, NY}
%%
%%  Uncomment \acmBooktitle if the title of the proceedings is different
%%  from ``Proceedings of ...''!
%%
%%\acmBooktitle{Woodstock '18: ACM Symposium on Neural Gaze Detection,
%%  June 03--05, 2018, Woodstock, NY}
% \acmISBN{978-1-4503-XXXX-X/2018/06}

%%
%% Submission ID.
%% Use this when submitting an article to a sponsored event. You'll
%% receive a unique submission ID from the organizers
%% of the event, and this ID should be used as the parameter to this command.
%%\acmSubmissionID{123-A56-BU3}

%%
%% For managing citations, it is recommended to use bibliography
%% files in BibTeX format.
%%
%% You can then either use BibTeX with the ACM-Reference-Format style,
%% or BibLaTeX with the acmnumeric or acmauthoryear sytles, that include
%% support for advanced citation of software artefact from the
%% biblatex-software package, also separately available on CTAN.
%%
%% Look at the sample-*-biblatex.tex files for templates showcasing
%% the biblatex styles.
%%

%%
%% The majority of ACM publications use numbered citations and
%% references, obtained by selecting the acmnumeric BibLaTeX style.
%% The acmauthoryear BibLaTeX style switches to the "author year" style.
%%
%% If you are preparing content for an event
%% sponsored by ACM SIGGRAPH, you must use the acmauthoryear style of
%% citations and references.
%%
%% Bibliography style
\RequirePackage[
  datamodel=acmdatamodel,
  style=acmnumeric,
]{biblatex}

%% Declare bibliography sources (one \addbibresource command per source)
\addbibresource{references.bib}

\usepackage{latex/agda}
\usepackage{tikz}
\usetikzlibrary{calc,arrows.meta,decorations.pathreplacing}

\usepackage{newunicodechar}
\newunicodechar{∎}{\ensuremath{∎}}
\newunicodechar{∷}{\ensuremath{∷}}
\newunicodechar{≋}{\ensuremath{≋}}
\newunicodechar{∙}{\ensuremath{∙}}
\newunicodechar{↺}{\ensuremath{↺}}
\newunicodechar{ₗ}{\textsubscript{L}}
\newunicodechar{ᵣ}{\textsubscript{R}}
\newunicodechar{ᴺ}{\textsubscript{N}}
\newunicodechar{ᴱ}{\textsubscript{E}}
\newunicodechar{ᴾ}{\textsubscript{P}}

%%
%% end of the preamble, start of the body of the document source.
\begin{document}

%%
%% The "title" command has an optional parameter,
%% allowing the author to define a "short title" to be used in page headers.
\title{The conatural numbers form an exponential commutative semiring}

%%
%% The "author" command and its associated commands are used to define
%% the authors and their affiliations.
%% Of note is the shared affiliation of the first two authors, and the
%% "authornote" and "authornotemark" commands
%% used to denote shared contribution to the research.
\author{Szumi Xie}
\orcid{0009-0001-1355-1114}
\affiliation{%
  \institution{Eötvös Loránd University (ELTE)}
  \city{Budapest}
  \country{Hungary}
}
\email{szumi@inf.elte.hu}

\author{Viktor Bense}
\orcid{0009-0005-9325-5225}
\affiliation{%
  \institution{Eötvös Loránd University (ELTE)}
  \city{Budapest}
  \country{Hungary}
}
\email{bense.viktor@inf.elte.hu}

%%
%% By default, the full list of authors will be used in the page
%% headers. Often, this list is too long, and will overlap
%% other information printed in the page headers. This command allows
%% the author to define a more concise list
%% of authors' names for this purpose.
% \renewcommand{\shortauthors}{Trovato et al.}

%%
%% The abstract is a short summary of the work to be presented in the
%% article.
\begin{abstract}
  Conatural numbers are a coinductive type dual to the inductively defined
  natural numbers. The conatural numbers can represent all natural numbers and
  an extra element for infinity, this can be useful for representing the amount
  of steps taken by a possibly non-terminating program. We can define functions
  on conatural numbers by corecursion, however proof assistants such as Agda
  require the corecursive definitions to be guarded to make sure that they are
  productive. This requirement is often too restrictive, as it disallows the
  corecursive occurrence to appear under previously defined operations. In this
  paper, we explore some methods to solving this issue using the running
  examples of multiplication and the commutativity of addition on conatural
  numbers, then we give comparisons between these methods.

  % TODO: Main result: First time proving conat is an exp comm semiring
  % no extension, vanilla cubical type theory, guardedness
\end{abstract}

%%
%% The code below is generated by the tool at http://dl.acm.org/ccs.cfm.
%% Please copy and paste the code instead of the example below.
%%
\begin{CCSXML}
  <ccs2012>
  <concept>
  <concept_id>10003752.10003790.10011740</concept_id>
  <concept_desc>Theory of computation~Type theory</concept_desc>
  <concept_significance>500</concept_significance>
  </concept>
  </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Theory of computation~Type theory}

%%
%% Keywords. The author(s) should pick words that accurately describe
%% the work being presented. Separate the keywords with commas.
\keywords{%
  Conatural number, Corecursion, Coinduction, Commutative semiring, Exponential
  semiring, Cubical Agda
}
%% A "teaser" image appears between the author and affiliation
%% information and the body of the document, and typically spans the
%% page.
% \begin{teaserfigure}
%   \includegraphics[width=\textwidth]{sampleteaser}
%   \caption{Seattle Mariners at Spring Training, 2010.}
%   \Description{Enjoying the baseball game from the third-base
%   seats. Ichiro Suzuki preparing to bat.}
%   \label{fig:teaser}
% \end{teaserfigure}

% \received{20 February 2007}
% \received[revised]{12 March 2009}
% \received[accepted]{5 June 2009}

%%
%% This command processes the author and affiliation and title
%% information and builds the first part of the formatted document.
\maketitle

\section{Introduction}\label{sec:intro}
\input{latex/Introduction}

\section{Naïve corecursion}\label{sec:problem}
\input{latex/Problem}

% Temintation checking error

\section{Direct corecusion}\label{sec:direct}
\input{latex/Direct}

% Proving everything directly
% using complicated states

\section{The embedded languages approach}\label{sec:dsl}
\input{latex/CompBisim}

% Compositionality
% Nils' method: Define a DSL to make corecursion guarded.

\section{A quotiented embedded language}\label{sec:quotiented}
\input{latex/Quotiented}

% Mixed inductive and coinductive type
% Make use of cubical agda's possibility to put proofs in data.

\section{Conclusion}

% TODO: we studied methods of reasoning about coinductive types

We presented three methods to formalise that conatural numbers form a
commutative semiring. To conclude, we give a short comparison between them.

% TODO: actual formalization, 3rd method successful

In Section~\ref{sec:direct} we directly used corecursion. Using this method we
did not have to consider creating an intermediate language. However, for every
operation and proof we have to come up with a new state that can accurately
describe the predecessor as the step of the proofs.
% Use this method if you are a masochist.

In Section~\ref{sec:dsl-mul} we followed Danielsson's
method~\cite{danielsson-beating} and created a domain speific language to define
the multiplication operation and later in Section~\ref{sec:dsl-comm} we defined
a language for proofs to obtain equational reasoning. The problem is we have to
define a new language for every new operation we want in which we have to
include every operation we want to reuse as a constructor in order to make Agda
see the definition as guarded which quickly leads to code duplication.

In Section~\ref{sec:quotiented} we extended our language using the idea that we
can include equations themselves using a mixed higher-inductive/coinductive
definition, which is only allowed in Cubical Agda. This method allows us to
reuse any other algebraic operation and equation that we are defining at the
same time. With it, we easily proved that conatural numbers form an exponential
commutative semiring. The only problem with this method is that it is not
modular. If we want to include more operations or properties that we define and
proofs, then we have to extend the already existing datatype of expressions.

We believe the last method can be generalised to definitions and proofs about
other coinductive types, so that one can easily reason about infinite programs.

% TODO: application of cubical Agda and univalence

% show case cubical type theory, reasoning about coinductive types simpler
% explore circumvent guardedness issue

\section{Future work}

Some questions remain as future work. The method in Section~\ref{sec:dsl} can
introduce code duplication, while the method in Section~\ref{sec:quotiented} is
not modular. We wish to find a modular method of doing corecursion that is as
convenient as these, where one can reuse other operations and equations, but
does not necessitate code duplication.

Another question is how one can define some more complicated operations, such as
tetration or the Ackermann function, on conatural numbers. Since conatural
numbers are a coinductive type, one defines operations by specifying the
predecessor, however, it is not clear how one can specify the predecessors of
the aforementioned operations.
% Agda experimental features

Lastly, in Section~\ref{sec:quotiented}, we used a mixed
higher-inductive/coinductive definition to specify the language of expressions,
though it is not clear what its semantic justification is, even though Agda
supports it. Unlike mixed inductive/coinductive types~\cite{hancock-stream}, we
cannot directly write it as the terminal coalgebra of some functor. If we were
to parametrise \AgdaDatatype{Expr} with \AgdaRecord{NExpr} and \AgdaField{pred},
then we would have $\AgdaField{pred} : \AgdaDatatype{Expr}\ \AgdaRecord{NExpr}\
\AgdaField{pred}$, where the type of \AgdaField{pred} depends on itself.

%%
%% Print the bibliography
%%
\printbibliography

\end{document}
\endinput
